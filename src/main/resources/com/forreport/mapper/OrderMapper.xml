<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.forreport.mapper.OrderMapper">
  
   <insert id="addOrder">
   		insert into tbl_order(ordernum, pronum, id, paymethod, payprice) 
   		values(seq_order.nextval, #{pronum}, #{id}, #{paymethod}, #{payprice})
   </insert>
   
   <select id="getOrderList" resultType="com.forreport.domain.OrderVO">
   		select ordernum, pronum, id, paymethod, payprice, orderdate
   		from tbl_order
   		where id = #{id}
   </select>
   
   <insert id="addVbank">
   		insert into tbl_vbank(id, vbnum, vbname, vbholder, vbdate) 
   		values(#{id}, #{vbnum}, #{vbname}, #{vbholder}, #{vbdate})
   </insert>
   
   <select id="getVbank" resultType="com.forreport.domain.VbankVO">
   		select * from tbl_vbank where id = #{id}
   </select>
   
   <!-- 페이징 처리(주문리스트) -->
   <select id="getOrderListAllWithPaging" resultType="com.forreport.domain.OrderVO">
   <![CDATA[	
   		select ordernum, pronum, id, paymethod, payprice, orderdate
   		from (select /*+INDEX_DESC(tbl_order pk_tbl_order)*/
   			  rownum rn, ordernum, pronum, id, paymethod, payprice, orderdate
   			  from tbl_order
   			  where rownum <= #{pageNum} * #{amount})
   		where rn > (#{pageNum} - 1) * #{amount}
   ]]>
   </select>
   
   <!-- 총 주문 개수 구하기 -->
   <select id="getTotalCount" resultType="int">
   <![CDATA[
   		select count(*) from tbl_order where ordernum > 0
   ]]>
   </select>
  
</mapper>





