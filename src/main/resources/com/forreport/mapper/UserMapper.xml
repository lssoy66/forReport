<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
  PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
  "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
  
<mapper namespace="com.forreport.mapper.UserMapper">
  
  <insert id="join">
  	insert into tbl_user values #{id}, #{password}, #{auth}, #{name}, #{phone}, #{email}, #{grade}
  </insert>
  
  <!-- id로 회원 불러오기 -->
  <select id="getUser" resultType="com.forreport.domain.UserVO">
    select * from tbl_user where id = #{id}
  </select>
  
  <!-- p662 ~ 3 : Mybatis를 사용하기 위한 xml -->
  <resultMap type="com.forreport.domain.UserVO" id="userMap">
		<id property="id" column="id"/>
		<result property="id" column="id"/>
		<result property="password" column="password"/>
		<result property="name" column="name"/>
		<result property="phone" column="phone"/>
		<result property="email" column="email"/>
		<result property="grade" column="grade"/>
		<collection property="authList" resultMap="authMap">
		</collection>		
	</resultMap>
	
	<resultMap type="com.forreport.domain.AuthVO" id="authMap">
  		<result property="id" column="id"/>
		<result property="auth" column="auth"/>
  	</resultMap>
  	
  	<select id="read" resultMap="userMap">
  		SELECT
  			mem.id, password, name, enabled, phone, email, grade, auth
  		FROM
  			tbl_user mem LEFT OUTER JOIN tbl_auth2 auth on mem.id = auth.id
  		WHERE mem.id = #{id}
  	</select>
  
</mapper>